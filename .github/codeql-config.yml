# CodeQL Analysis Configuration
name: "JavaScript Security Analysis"

# Specify which files to analyze
paths:
  - '.'

paths-ignore:
  - '**/node_modules'
  - '**/dist'
  - '**/build'

# Query specifications
queries:
  - uses: security-and-quality
  - uses: security-extended
  - uses: codeql/javascript-queries@main
  - uses: codeql-custom-queries-javascript
  
query-filters:
  - include:
      tags contain:
        - "security"
        - "correctness"

# Database settings
database:
  analyze:
    language: javascripton file to ensure all JavaScript files are analyzed
name: "Full JS Analysis"

paths-ignore:
  - "**/node_modules"
  - "**/dist"
  - "**/build"

paths:
  - "."

queries:
  - uses: security-and-quality
  - uses: security-extended
  # Additional query suites for JavaScript
  - uses: ./javascript/ql/src/Security/CWE-078 # Command Injection
  - uses: ./javascript/ql/src/Security/CWE-079 # XSS
  - uses: ./javascript/ql/src/Security/CWE-089 # SQL Injection
  - uses: ./javascript/ql/src/Security/CWE-094 # Code Injection
  - uses: ./javascript/ql/src/Security/CWE-502 # Unsafe Deserialization

# Enable non-default queries
disable-default-queries: false

# Enable more detailed analysis
optimize: true
